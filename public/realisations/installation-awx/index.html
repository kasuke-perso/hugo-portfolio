<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="Florian Dugat ">
<meta name="description"
    content="On va se servir d&amp;rsquo;Ubuntu 17.10 et on aura besoin d&amp;rsquo;une connexion internet.
Nous allons installer quelques paquets qui seront utiles pour que Ansible et AWX fonctionnent correctement.
Premièrement, il faudra mettre à jour son source-list.
sudo apt update Ensuite procédé à l&amp;rsquo;installation de quelques paquets:
sudo apt install python-minimal open-ssh htop Ceci va installer python2.7.x, un serveur ssh pour avoir accès à la machine via ssh et htop un meilleur top" />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="http://florian.katech.net/realisations/installation-awx/" />


<title>
    
    Installation AWX :: Florian DUGAT 
    
</title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.cabb110faab88d3545467f36114f6bf3ac23f81434679cf37338752570b2eda1.css">



<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="theme-color" content="#252627"><meta itemprop="name" content="Installation AWX">
<meta itemprop="description" content="On va se servir d&rsquo;Ubuntu 17.10 et on aura besoin d&rsquo;une connexion internet.
Nous allons installer quelques paquets qui seront utiles pour que Ansible et AWX fonctionnent correctement.
Premièrement, il faudra mettre à jour son source-list.
sudo apt update Ensuite procédé à l&rsquo;installation de quelques paquets:
sudo apt install python-minimal open-ssh htop Ceci va installer python2.7.x, un serveur ssh pour avoir accès à la machine via ssh et htop un meilleur top"><meta itemprop="datePublished" content="2018-08-05T09:45:10+02:00" />
<meta itemprop="dateModified" content="2018-08-05T09:45:10+02:00" />
<meta itemprop="wordCount" content="664">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Installation AWX"/>
<meta name="twitter:description" content="On va se servir d&rsquo;Ubuntu 17.10 et on aura besoin d&rsquo;une connexion internet.
Nous allons installer quelques paquets qui seront utiles pour que Ansible et AWX fonctionnent correctement.
Premièrement, il faudra mettre à jour son source-list.
sudo apt update Ensuite procédé à l&rsquo;installation de quelques paquets:
sudo apt install python-minimal open-ssh htop Ceci va installer python2.7.x, un serveur ssh pour avoir accès à la machine via ssh et htop un meilleur top"/>




<meta property="article:published_time" content="2018-08-05 09:45:10 &#43;0200 CEST" />







    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="http://florian.katech.net" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text"># cd /home</span>
            <span class="logo__cursor"></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="http://florian.katech.net/realisations">Réalisations</a></li><li><a href="http://florian.katech.net/experience">Expériences</a></li><li><a href="http://florian.katech.net/blog">Blog</a></li><li><a href="http://florian.katech.net/about">A propos</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
                Aussi disponible en
                
                    <a href="http://florian.katech.net/en/realisations/installation-awx/"><span class="flag flag-icon flag-icon-gb flag-icon-squared"></span></a>
                
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="http://florian.katech.net/realisations/installation-awx/">Installation AWX</a></h2>

            

            <div class="post-content">
                <p>On va se servir d&rsquo;Ubuntu 17.10 et on aura besoin d&rsquo;une connexion internet.</p>
<p>Nous allons installer quelques paquets qui seront utiles pour que Ansible et AWX fonctionnent correctement.</p>
<p>Premièrement, il faudra mettre à jour son source-list.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo apt update
</code></pre></div><p>Ensuite procédé à l&rsquo;installation de quelques paquets:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo apt install python-minimal open-ssh htop
</code></pre></div><p>Ceci va installer python2.7.x, un serveur ssh pour avoir accès à la machine via ssh et <code>htop</code> un meilleur <code>top</code></p>
<p>Ensuite nous allons télécharger Ansible mais on va le faire via les sources d&rsquo;Ansible car dans  les repo officiel, la version d&rsquo;Ansible n&rsquo;est pas la bonne pour que tout fonctionne, il faut absolument être à une version &gt;= 2.4 sinon AWX ne sera pas installable.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo apt-add-repository ppa:ansible/ansible
sudo apt update
sudo apt install ansible
</code></pre></div><p>Nous aurons besoin aussi de docker pour installer AWX car s&rsquo;en est dépendend et AWX ne fonctionnera qu&rsquo;avec un container si on veut un AWX local. La version des repo officiel suffira.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo apt install docker.io
</code></pre></div><p>Pour vérifier si l&rsquo;installation s&rsquo;est bien déroulé, éxécutez cette commande:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo docker run hello-world
</code></pre></div><p>Ceci devrait activer le service docker, téléchargeons l&rsquo;image &lsquo;hello world&rsquo; et executons la. Pour vérfier si le service est en train de fonctionner executons cette commande :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">systemctl status docker
</code></pre></div><p>Cela devrait nous dire que Docker est actif et en fonctionnement. Pour avoir le service docker à chaque démarrage il suffit de faire ceci :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">systemctl enable docker
</code></pre></div><p>Nous aurons besoin de &lsquo;pip&rsquo; pour l&rsquo;installation des paquets python, nous aurons aussi besoin de git mais il devrait être déjà installé par défaut sur Ubuntu serveur.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo apt install python-pip
</code></pre></div><p>Nous aurons besoin d&rsquo;installer la library python docker aussi</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pip install docker
</code></pre></div><p>Si vous voulez avoir un &lsquo;man&rsquo; un peu plus facile d&rsquo;utilisation avec des exemples, je vous suggère d&rsquo;installer ces deux paquets python</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pip install eg cheat
</code></pre></div><p>Je suggère également d&rsquo;installer &lsquo;tree&rsquo; qui va nous faciliter la tâche pour avoir une vue d&rsquo;ensemble des fichiers et des dossiers.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo apt install tree
</code></pre></div><p>Maintenant, nous allons passer à l&rsquo;installation d&rsquo;AWX, nous aurons besoin de cloner le github d&rsquo;AWX, nous avons déjà github (2.14.1)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">git clone https://github.com/ansible/awx 	
</code></pre></div><p>Ensuite allons dans le dossier d&rsquo;installation d&rsquo;AWX</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">cd awx/installer
</code></pre></div><p>Nous avons besoin de changer quelques lignes dans le fichier d&rsquo;inventaire</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">vim inventory
</code></pre></div><p>décommentons cette ligne</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># project_data_dir=/var/lib/awx/projects</span>
</code></pre></div><p>Il faudra aussi changer cette ligne</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">dockerhub_version<span style="color:#f92672">=</span>latest
</code></pre></div><p>par celle-là</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">dockerhub_version<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</code></pre></div><p>Décommentons cette ligne</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># use_docker_compose=false</span>
</code></pre></div><p>Puisque nous voulons que nos données persistent, on  va changer cette ligne</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">postgres_data_dir<span style="color:#f92672">=</span>/tmp/pgdocker
</code></pre></div><p>Par celle-ci</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">postgres_data_dir<span style="color:#f92672">=</span>/opt/pgdocker
</code></pre></div><p>Ensuite nous pouvons procéder à l&rsquo;execution du playbook pour  l&rsquo;installation.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo ansible-playbook –i inventory install.yml
</code></pre></div><p>Si tout s&rsquo;est bien déroulé, on peut voir la progression de l&rsquo;installation en regardant les logs d&rsquo;awx_task dans le container</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo docker logs –f awx_task
</code></pre></div><p>Nous allons voir des logs semblable à ceci :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">Using /etc/ansible/ansible.cfg as config file
127.0.0.1 | SUCCESS <span style="color:#f92672">=</span>&gt; <span style="color:#f92672">{</span>
    <span style="color:#e6db74">&#34;changed&#34;</span>: false,
    <span style="color:#e6db74">&#34;db&#34;</span>: <span style="color:#e6db74">&#34;awx&#34;</span>
<span style="color:#f92672">}</span>
Operations to perform:
  Synchronize unmigrated apps: solo, api, staticfiles, messages, channels, django_extensions, ui, rest_framework, polymorphic
  Apply all migrations: sso, taggit, sessions, djcelery, sites, kombu_transport_django, social_auth, contenttypes, auth, conf, main
Synchronizing apps without migrations:
  Creating tables...
    Running deferred SQL...
  Installing custom SQL...
Running migrations:
  Rendering model states... DONE
  Applying contenttypes.0001_initial... OK
  Applying contenttypes.0002_remove_content_type_name... OK
  Applying auth.0001_initial... OK
  Applying auth.0002_alter_permission_name_max_length... OK
  Applying auth.0003_alter_user_email_max_length... OK
  Applying auth.0004_alter_user_username_opts... OK
  Applying auth.0005_alter_user_last_login_null... OK
  Applying auth.0006_require_contenttypes_0002... OK
  Applying taggit.0001_initial... OK
  Applying taggit.0002_auto_20150616_2121... OK
  Applying main.0001_initial... OK
...
</code></pre></div><p>Quand la migration est finie, nous verrons ces logs, indiquant que la migration est terminée:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">&gt;&gt;&gt; &lt;User: admin&gt;
&gt;&gt;&gt; Default organization added.
Demo Credential, Inventory, and Job Template added.
Successfully registered instance awx
<span style="color:#f92672">(</span>changed: True<span style="color:#f92672">)</span>
Creating instance group tower
Added instance awx to tower
<span style="color:#f92672">(</span>changed: True<span style="color:#f92672">)</span>
...
</code></pre></div><p>La prochaine étape est de créer un dossier au sein du projet AWX</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo mkdir /var/lib/awx/projects/your_project_name
</code></pre></div><p>Et  d&rsquo;y mettre tout ce dont on aura besoin : playbooks, ressources, fichiers, dossiers. Si vous ne  mettez pas tout dans ce dossier précis, AWX ne le verra pas et si vous ne créez pas le dossier, AWX ne vous laissera pas faire un projet local.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
  			</div>

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2025</span>
            
                <span><a href="http://florian.katech.net">Florian Dugat</a></span>
            
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span> <a href="http://florian.katech.net/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">

        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.648cbdb411bb57181906d73a5e1c9f26680cde5c03e04de5350e4d20c491ff3db990efb0d71e1fd5f57604f06c78379555c7f829c9bf6c2782acfd6471867611.js" integrity="sha512-ZIy9tBG7VxgZBtc6XhyfJmgM3lwD4E3lNQ5NIMSR/z25kO&#43;w1x4f1fV2BPBseDeVVcf4Kcm/bCeCrP1kcYZ2EQ=="></script>



    </body>
</html>
